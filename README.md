# Analysing MEV on Algorand
## DEX Price Scraper
### Real-Time DEX Info Scraper
```
$ python src/realtime_dex_price_scraper.py
```
Run on server in the backtround (and kill the process if you want to end it).
```
$ nohup python src/realtime_dex_price_scraper.py &
$ pgrep -f realtime_dex_price_scraper.py
$ kill <process ID>
```
Output
```
Binance_ALGOUSDT,timestamp,round:,HUMBLESWAP_ALGOUSDC,pool_size_X,pool_size_Y,round:,HUMBLESWAP_ALGOgoUSD,pool_size_X,pool_size_Y,round:,PACT_ALGOUSDC,pool_size_X,pool_size_Y,round:,PACT_ALGOUSDT,pool_size_X,pool_size_Y,round:,TINYMAN_ALGOUSDC,pool_size_X,pool_size_Y,round:,TINYMAN_ALGOUSDT,pool_size_X,pool_size_Y
0.24575,1674694149.84,26522436,0.2451717556540756,3113071417810,763237184981,26522436,0.2448620844881125,226716298965,55514225552,26522436,0.24504287134942324,1731027924906,424176053105,26522436,0.2365567269849801,18944661,4481487,26522436,0.24474284501934707,1203830828802,294628981963,26522436,0.24906814028185406,43491482635,10832342698
0.24585,1674694155.73,26522437,0.2451717556540756,3113071417810,763237184981,26522437,0.2448620844881125,226716298965,55514225552,26522437,0.24504287134942324,1731027924906,424176053105,26522437,0.2365567269849801,18944661,4481487,26522437,0.24474284501934707,1203830828802,294628981963,26522437,0.24906814028185406,43491482635,10832342698
0.24595,1674694159.31,26522438,0.2451717556540756,3113071417810,763237184981,26522438,0.2448620844881125,226716298965,55514225552,26522438,0.24504287134942324,1731027924906,424176053105,26522438,0.2365567269849801,18944661,4481487,26522438,0.24474284501934707,1203830828802,294628981963,26522438,0.24906814028185406,43491482635,10832342698
0.24595,1674694165.43,26522440,0.2452508205288513,3112569889715,763360319406,26522440,0.2448620844881125,226716298965,55514225552,26522440,0.24504287134942324,1731027924906,424176053105,26522440,0.2365567269849801,18944661,4481487,26522440,0.24474284501934707,1203830828802,294628981963,26522440,0.24906814028185406,43491482635,10832342698
```
### Real-Time DEX Price Converter
Extract only prices out of that csv file:
```
$ python src/create_price_data_of_responses.py "../data/responses_XXXXXXXXXX.csv"
```
Output
```
timestamp,binance_algousdt,humbleswap_algousdc,humbleswap_algogousd,pact_algousdc,pact_algousdt,tinyman_algousdc,tinyman_algousdt
1674694149.84,0.24575,0.2451717556540756,0.2448620844881125,0.24504287134942324,0.2365567269849801,0.24474284501934707,0.24906814028185406
1674694155.73,0.24585,0.2451717556540756,0.2448620844881125,0.24504287134942324,0.2365567269849801,0.24474284501934707,0.24906814028185406
1674694159.31,0.24595,0.2451717556540756,0.2448620844881125,0.24504287134942324,0.2365567269849801,0.24474284501934707,0.24906814028185406
1674694165.43,0.24595,0.2452508205288513,0.2448620844881125,0.24504287134942324,0.2365567269849801,0.24474284501934707,0.24906814028185406
```

## Parse Historic AMM Swap Interactions
E.g. parse block number 25729521.
```
python block_tx_scraper.py 25729521 25729522
```
Output ([Swap on DEX](https://algoexplorer.io/tx/group/xOfl513cvxwdHkdTEHhqB%2BmuQ8Z%2F4pLcC9iXCGImw4A%3D)):
```
[
  {
    "payment-transaction": {
      "amount": 300000,
      "close-amount": 0,
      "receiver": "SVZS7Q7QMVHZONDHZJHR4564VTMEX3OQ5DSYBWKR5FJFTPZLVG3EZIWC34"
    },
    ...
    "sender": "NNEJ6IOFB2D7EUA2VHTFVAUNLY2XZGBMXG5WUW2XJ3IBAJPUW4PNTZ7KIA",
    ...
    "tx-type": "pay"
  },
  {
    "application-transaction": {
      ...
      "application-id": 777628254,
      "foreign-assets": [31566704],
      ...
    },
    ...
    "group": "xOfl513cvxwdHkdTEHhqB+muQ8Z/4pLcC9iXCGImw4A=",
    "id": "2LOER3TT4FUJM6FHQZPME6OX56ZMFP2CTGB3RK5HOX44T7PPHGIA",
    "inner-txns": [
      {
        "asset-transfer-transaction": {
          "amount": 71751,
          "asset-id": 31566704,
          "close-amount": 0,
          "receiver": "NNEJ6IOFB2D7EUA2VHTFVAUNLY2XZGBMXG5WUW2XJ3IBAJPUW4PNTZ7KIA"
        },
        ...
        "sender": "SVZS7Q7QMVHZONDHZJHR4564VTMEX3OQ5DSYBWKR5FJFTPZLVG3EZIWC34"
      }
    ],
    ...
    "sender": "NNEJ6IOFB2D7EUA2VHTFVAUNLY2XZGBMXG5WUW2XJ3IBAJPUW4PNTZ7KIA"
  }
]
```
