# DEX Analytics on Algorand 

[https://jonasgebele-algo-mev-dashboarddashboard-cgj79v.streamlit.app/](https://jonasgebele-algo-mev-dashboarddashboard-cgj79v.streamlit.app/)

Price Chart of most popular DEX'es on Algorand with Querie-Function for market-maker.
![image](https://user-images.githubusercontent.com/41921050/222264203-054055b8-c5da-47bc-a86e-3e6dd8da2936.png)

Transaction-Flow summary.
![image](https://user-images.githubusercontent.com/41921050/222263962-4d23ad83-1cca-4dd5-9eb8-18789ebb5128.png)


Run locally with
```
streamlit run dashboard/Dashboard.py
```

## On-Chain Data-Mining

### DEX Price Scraper

```
$ python realtime_price_scraper.py
```

Run on server in the backtround (and kill the process if you want to end it).

```
$ nohup python realtime_price_scraper.py &
$ pgrep -f realtime_price_scraper.py
$ kill <process ID>
```

Output

```
Binance_ALGOUSDT,timestamp,round:,HUMBLESWAP_ALGOUSDC,pool_size_X,pool_size_Y,round:,HUMBLESWAP_ALGOgoUSD,pool_size_X,pool_size_Y,round:,PACT_ALGOUSDC,pool_size_X,pool_size_Y,round:,PACT_ALGOUSDT,pool_size_X,pool_size_Y,round:,TINYMAN_ALGOUSDC,pool_size_X,pool_size_Y,round:,TINYMAN_ALGOUSDT,pool_size_X,pool_size_Y
0.24575,1674694149.84,26522436,0.2451717556540756,3113071417810,763237184981,26522436,0.2448620844881125,226716298965,55514225552,26522436,0.24504287134942324,1731027924906,424176053105,26522436,0.2365567269849801,18944661,4481487,26522436,0.24474284501934707,1203830828802,294628981963,26522436,0.24906814028185406,43491482635,10832342698
0.24585,1674694155.73,26522437,0.2451717556540756,3113071417810,763237184981,26522437,0.2448620844881125,226716298965,55514225552,26522437,0.24504287134942324,1731027924906,424176053105,26522437,0.2365567269849801,18944661,4481487,26522437,0.24474284501934707,1203830828802,294628981963,26522437,0.24906814028185406,43491482635,10832342698
0.24595,1674694159.31,26522438,0.2451717556540756,3113071417810,763237184981,26522438,0.2448620844881125,226716298965,55514225552,26522438,0.24504287134942324,1731027924906,424176053105,26522438,0.2365567269849801,18944661,4481487,26522438,0.24474284501934707,1203830828802,294628981963,26522438,0.24906814028185406,43491482635,10832342698
0.24595,1674694165.43,26522440,0.2452508205288513,3112569889715,763360319406,26522440,0.2448620844881125,226716298965,55514225552,26522440,0.24504287134942324,1731027924906,424176053105,26522440,0.2365567269849801,18944661,4481487,26522440,0.24474284501934707,1203830828802,294628981963,26522440,0.24906814028185406,43491482635,10832342698
```

### Dataset Creation

#### Price Dataset

Extract only prices out of that csv file:

```
$ python create_datasets.py <command> [<args>]
```

Where <command> is either "prices" or "transactions" and <args> are the additional arguments required for that command. Here are some examples:

To create the prices dataset

```
$ python create_dataset.py prices /path/to/prices.csv
```
Output
```
block-height,timestamp,binance_algousdt,humbleswap_algousdc,humbleswap_algogousd,pact_algousdc,pact_algousdt,tinyman_algousdc,tinyman_algousdt
26522436,1674694149.84,0.24575,0.2451717556540756,0.2448620844881125,0.24504287134942324,0.2365567269849801,0.24474284501934707,0.24906814028185406
26522437,1674694155.73,0.24585,0.2451717556540756,0.2448620844881125,0.24504287134942324,0.2365567269849801,0.24474284501934707,0.24906814028185406
26522438,1674694159.31,0.24595,0.2451717556540756,0.2448620844881125,0.24504287134942324,0.2365567269849801,0.24474284501934707,0.24906814028185406
26522440,1674694165.43,0.24595,0.2452508205288513,0.2448620844881125,0.24504287134942324,0.2365567269849801,0.24474284501934707,0.24906814028185406
```

#### Transaction Dataset

To create a transactions dataset from a source file with start and end rounds.

```
$ python create_dataset.py transactions round-start round-end
```
```
round,group_id,sender,receiver,application-id,amount_send,asset_id_send,amount_received,asset_id_received
26814040,YPxyZ/kQnxnGJT5DB9tEDB1EPCy2DbzrVlVaKaq6MGg=,W2IZ3EHDRW2IQNPC33CI2CXSLMFCFICVKQVWIYLJWXCTD765RW47ONNCEY,SVZS7Q7QMVHZONDHZJHR4564VTMEX3OQ5DSYBWKR5FJFTPZLVG3EZIWC34,777628254,500000000,0,137006317,31566704
26814040,lSmNvnTX7tQUrJnGg8hX2TnHUsScsp2visD2hNKl+Xo=,W2IZ3EHDRW2IQNPC33CI2CXSLMFCFICVKQVWIYLJWXCTD765RW47ONNCEY,L747MOJV43QCLY4HSWVPL2A5SW62IBLA5XPTI5R4HO32WVAWOO5OBCEP3A,620995314,500000000,0,136872842,31566704
26814043,UBGLzvRIyKao6/L5+sx6L/xJfHv7H3Q6j/rx/jTCjro=,7CRK6G4IG2BNQFVEDQIARD2DEVUK5M5K66DPRPP6HMIO7FLHACXSAL2UNA,PL7GUDUYPEGBNSY36HOPUFNQDBWDTCSRUV7R7WCPP6VQVGBSTEXMFSCJ2E,552635992,19750666619,300208676,2000,0
26814046,+7jnCDKig5iBrcd1PkTtoeJZBa3RoOOHI/XG02gJyGU=,7CRK6G4IG2BNQFVEDQIARD2DEVUK5M5K66DPRPP6HMIO7FLHACXSAL2UNA,PL7GUDUYPEGBNSY36HOPUFNQDBWDTCSRUV7R7WCPP6VQVGBSTEXMFSCJ2E,552635992,199504466,300208676,2000,0
```  
E.g. block number 26814040 with two transactions ([Swap on DEX](https://algoexplorer.io/tx/group/xOfl513cvxwdHkdTEHhqB%2BmuQ8Z%2F4pLcC9iXCGImw4A%3D))

```
[
  {
    "round": 26814040,
    "group_id": "YPxyZ/kQnxnGJT5DB9tEDB1EPCy2DbzrVlVaKaq6MGg=",
    "sender": "W2IZ3EHDRW2IQNPC33CI2CXSLMFCFICVKQVWIYLJWXCTD765RW47ONNCEY",
    "receiver": "SVZS7Q7QMVHZONDHZJHR4564VTMEX3OQ5DSYBWKR5FJFTPZLVG3EZIWC34",
    "application-id": 777628254,
    "amount_send": 500000000,
    "asset_id_send": 0,
    "amount_received": 137006317,
    "asset_id_received": 31566704
  },
  {
    "round": 26814040,
    "group_id": "lSmNvnTX7tQUrJnGg8hX2TnHUsScsp2visD2hNKl+Xo=",
    "sender": "W2IZ3EHDRW2IQNPC33CI2CXSLMFCFICVKQVWIYLJWXCTD765RW47ONNCEY",
    "receiver": "L747MOJV43QCLY4HSWVPL2A5SW62IBLA5XPTI5R4HO32WVAWOO5OBCEP3A",
    "application-id": 620995314,
    "amount_send": 500000000,
    "asset_id_send": 0,
    "amount_received": 136872842,
    "asset_id_received": 31566704
  }
]
```
